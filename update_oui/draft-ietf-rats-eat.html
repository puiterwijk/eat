<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>The Entity Attestation Token (EAT)</title>

  
<style type="text/css">/*<![CDATA[*/

body {
  font: 16px "Helvetica Neue","Open Sans",Helvetica,Calibri,sans-serif;
  color: #333;
  font-size-adjust: 0.5;
  line-height: 24px;
  margin: 75px auto;
  max-width: 624px;
  padding: 0 5px;
}

.title, .filename, h1, h2, h3, h4, h5 {
  font: 16px "Roboto Condensed","Helvetica Neue","Open Sans",Helvetica,Calibri,sans-serif;
  font-size-adjust: 0.5;
  font-weight: bold;
  color: #333;
  line-height: 100%;
  margin: 1.2em 0 0.3em;
}
.title, #rfc\.title h1 { font-size: 32px; }
h1, section h1, h2, section h2, section h3, nav h2 { font-size: 20px; }
h3, section h4, h4, section h5 { font-size: 16px; }
h1 a[href], h2 a[href], h3 a[href], h4 a[href] {
  color: #333;
}

table {
  margin-left: 0em;
  border-collapse: collapse;
}
th {
  text-align: left;
  border-bottom: 2px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
  vertical-align: top;
}
tr:nth-child(2n+1) > td,
tr:nth-child(2n+1) > th {
  background-color: #f9f9f9;
}
td.reference {
  max-width: 200px;
  border-top: none;
  padding-right: 1em;
}
.right {
  text-align: right;
}


table.header, table#rfc\.headerblock {
  width: 100%;
}
table.header td, table#rfc\.headerblock td {
  border: none;
  background-color: transparent;
  color: black;
  padding: 0;
}
.filename {
  display: block;
  color: rgb(119, 119, 119);
  font-size: 20px;
  font-weight: normal;
  line-height: 100%;
  margin: 10px 0 32px;
}
#rfc\.abstract+p, #rfc\.abstract+p code, #rfc\.abstract+p samp, #rfc\.abstract+p tt {
  font-size: 20px;
  line-height: 28px;
}

samp, tt, code, pre, span.tt {
  font-size: 13.5px;
  font-family: Consolas, monospace;
  font-size-adjust: none;
}
pre {
  background-color: #eee;
  border: 1px solid #ddd;
  overflow-x: auto;
  padding: 5px;
  margin: 5px;
}
.figure, caption {
  font-style: italic;
  margin: 0 1.5em;
  text-align: left;
}

address {
  margin: 16px 2px;
  line-height: 20px;
}
.vcard {
  font-style: normal;
}
.vcardline {
  display: block;
}
.vcardline .fn, address b {
  font-weight: normal;
}
.vcardline .hidden {
  display: none;
}

dl {
  margin-left: 1em;
}
dl.dl-horizontal: {
  margin-left: 0;
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl.nohang > dt {
  float: none;
}
dl > dd {
  margin-bottom: .5em;
}
dl.compact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
ul.empty {
  list-style-type: none;
}
ul.empty li {
  margin-top: .5em;
}

hr {
  border: 0;
  border-top: 1px solid #eee;
}
hr.noprint {
  display: none;
}

a {
  text-decoration: none;
}
a[href] {
  color: #2a6496;
}
a[href]:hover {
  background-color: #eee;
}

p, ol, ul, li {
  padding: 0;
}
p {
  margin: 0.5em 0;
}
ol, ul {
  margin: 0.2em 0 0.2em 2em;
}
li {
  margin: 0.2em 0;
}
address {
  font-style: normal;
}

ul.toc ul {
  margin: 0 0 0 2em;
}
ul.toc li {
  list-style: none;
  margin: 0;
}

@media screen and (min-width: 924px) {
  body {
    padding-right: 350px;
  }
  body>ul.toc, body>#rfc\.toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 500px);
    width: 300px;
    z-index: 1;
    overflow: auto;
    overscroll-behavior: contain;
  }
  body>#rfc\.toc {
    top: 55px;
  }
  body>ul.toc {
    top: 100px;
  }

  ul.toc {
    margin: 0 0 0 4px;
    font-size: 12px;
    line-height: 20px;
  }
  ul.toc ul {
    margin-left: 1.2em;
  }
}

.github-fork-ribbon-wrapper {
  display: none;
}
@media screen and (min-width: 800px) {
  /* "Fork me on GitHub" CSS ribbon based on
   * https://github.com/simonwhitaker/github-fork-ribbon-css
   */
  .github-fork-ribbon {
    position: absolute;
    padding: 2px 0;
    background-color: #a00;
    background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.15));
    box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.5);
    font: 700 12px "Helvetica Neue", Helvetica, Arial, sans-serif;

    pointer-events: auto;

    top: 38px;
    right: -45px;

    transform: rotate(45deg);
  }

  .github-fork-ribbon a[href],
  .github-fork-ribbon a[href]:hover {
    color: #fff;
    background-color: transparent;
    text-decoration: none;
    text-shadow: 0 -1px rgba(0, 0, 0, 0.5);
    text-align: center;

    width: 190px;
    line-height: 18px;

    display: inline-block;
    padding: 2px 0;

    border: 1.5px dotted #fff;
    border-color: rgba(255, 255, 255, 0.6);
  }

  .github-fork-ribbon-wrapper {
    display: block;
    width: 130px;
    height: 130px;
    position: absolute;
    overflow: hidden;
    top: 0; right: 0;
    z-index: 2;
    pointer-events: none;
  }
}
@media screen and (min-width: 1000px) {
  .github-fork-ribbon-wrapper {
    position: fixed;
  }
  /*]]>*/</style>
  <meta name="viewport" content="initial-scale=1.0">


  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 CDDL, CWT and JWT">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Entity Overview">
<link href="#rfc.section.1.3" rel="Chapter" title="1.3 EAT Operating Models">
<link href="#rfc.section.1.4" rel="Chapter" title="1.4 What is Not Standardized">
<link href="#rfc.section.1.4.1" rel="Chapter" title="1.4.1 Transmission Protocol">
<link href="#rfc.section.1.4.2" rel="Chapter" title="1.4.2 Signing Scheme">
<link href="#rfc.section.2" rel="Chapter" title="2 Terminology">
<link href="#rfc.section.3" rel="Chapter" title="3 The Claims Information Model">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Nonce Claim (cti and jti)">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Timestamp claim (iat)">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Universal Entity ID Claim (ueid)">
<link href="#rfc.section.3.3.1" rel="Chapter" title="3.3.1 CDDL">
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 Origination Claim (origination)">
<link href="#rfc.section.3.4.1" rel="Chapter" title="3.4.1 CDDL">
<link href="#rfc.section.3.5" rel="Chapter" title="3.5 OEM identification by IEEE (oemid)">
<link href="#rfc.section.3.5.1" rel="Chapter" title="3.5.1 CDDL">
<link href="#rfc.section.3.6" rel="Chapter" title="3.6 The Security Level Claim (security_level)">
<link href="#rfc.section.3.6.1" rel="Chapter" title="3.6.1 CDDL">
<link href="#rfc.section.3.7" rel="Chapter" title="3.7 Secure Boot and Debug Enable State Claims (boot_state)">
<link href="#rfc.section.3.7.1" rel="Chapter" title="3.7.1 Secure Boot Enabled">
<link href="#rfc.section.3.7.2" rel="Chapter" title="3.7.2 Debug Disabled">
<link href="#rfc.section.3.7.3" rel="Chapter" title="3.7.3 Debug Disabled Since Boot">
<link href="#rfc.section.3.7.4" rel="Chapter" title="3.7.4 Debug Permanent Disable">
<link href="#rfc.section.3.7.5" rel="Chapter" title="3.7.5 Debug Full Permanent Disable">
<link href="#rfc.section.3.7.6" rel="Chapter" title="3.7.6 CDDL">
<link href="#rfc.section.3.8" rel="Chapter" title="3.8 The Location Claim (location)">
<link href="#rfc.section.3.8.1" rel="Chapter" title="3.8.1 CDDL">
<link href="#rfc.section.3.9" rel="Chapter" title="3.9 The Age Claim (age)">
<link href="#rfc.section.3.10" rel="Chapter" title="3.10 The Uptime Claim (uptime)">
<link href="#rfc.section.3.10.1" rel="Chapter" title="3.10.1 CDDL">
<link href="#rfc.section.3.11" rel="Chapter" title="3.11 Nested EATs, the EAT Claim (nested_eat)">
<link href="#rfc.section.3.11.1" rel="Chapter" title="3.11.1 CDDL">
<link href="#rfc.section.3.12" rel="Chapter" title="3.12 The Submods Claim (submods)">
<link href="#rfc.section.3.12.1" rel="Chapter" title="3.12.1 The submod_name Claim">
<link href="#rfc.section.3.12.2" rel="Chapter" title="3.12.2 CDDL">
<link href="#rfc.section.4" rel="Chapter" title="4 Data Model">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Common CDDL Types">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 CDDL for CWT-defined Claims">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 JSON">
<link href="#rfc.section.4.3.1" rel="Chapter" title="4.3.1 JSON Labels">
<link href="#rfc.section.4.3.2" rel="Chapter" title="4.3.2 JSON Interoperability">
<link href="#rfc.section.4.4" rel="Chapter" title="4.4 CBOR">
<link href="#rfc.section.4.4.1" rel="Chapter" title="4.4.1 Labels">
<link href="#rfc.section.4.4.2" rel="Chapter" title="4.4.2 CBOR Types">
<link href="#rfc.section.4.4.3" rel="Chapter" title="4.4.3 CBOR Interoperability">
<link href="#rfc.section.4.5" rel="Chapter" title="4.5 Collected CDDL">
<link href="#rfc.section.5" rel="Chapter" title="5 IANA Considerations">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 Reuse of CBOR Web Token (CWT) Claims Registry">
<link href="#rfc.section.5.1.1" rel="Chapter" title="5.1.1 Claims Registered by This Document">
<link href="#rfc.section.6" rel="Chapter" title="6 Privacy Considerations">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 UEID Privacy Considerations">
<link href="#rfc.section.7" rel="Chapter" title="7 Security Considerations">
<link href="#rfc.references" rel="Chapter" title="8 References">
<link href="#rfc.references.1" rel="Chapter" title="8.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="8.2 Informative References">
<link href="#rfc.appendix.A" rel="Chapter" title="A Examples">
<link href="#rfc.appendix.A.1" rel="Chapter" title="A.1 Very Simple EAT">
<link href="#rfc.appendix.A.2" rel="Chapter" title="A.2 Example with Submodules, Nesting and Security Levels">
<link href="#rfc.appendix.B" rel="Chapter" title="B Changes from Previous Drafts">
<link href="#rfc.appendix.B.1" rel="Chapter" title="B.1 From draft-mandyam-rats-eat-00">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.33.0 - https://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Mandyam, G., Lundblade, L., Ballesteros, M., and J. O'Donoghue" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-ietf-rats-eat-latest" />
  <meta name="dct.issued" scheme="ISO8601" content="2019-10-17" />
  <meta name="dct.abstract" content="An Entity Attestation Token (EAT) provides a signed (attested) set of claims that describe state and characteristics of an entity, typically a device like a phone or an IoT device.  These claims are used by a relying party to determine how much it wishes to trust the entity.An EAT is either a CWT or JWT with some attestation-oriented claims. To a large degree, all this document does is extend CWT and JWT." />
  <meta name="description" content="An Entity Attestation Token (EAT) provides a signed (attested) set of claims that describe state and characteristics of an entity, typically a device like a phone or an IoT device.  These claims are used by a relying party to determine how much it wishes to trust the entity.An EAT is either a CWT or JWT with some attestation-oriented claims. To a large degree, all this document does is extend CWT and JWT." />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">RATS Working Group</td>
<td class="right">G. Mandyam</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Qualcomm Technologies Inc.</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">L. Lundblade</td>
</tr>
<tr>
<td class="left">Expires: April 19, 2020</td>
<td class="right">Security Theory LLC</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">M. Ballesteros</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">J. O'Donoghue</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Qualcomm Technologies Inc.</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">October 17, 2019</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">The Entity Attestation Token (EAT)<br />
  <span class="filename">draft-ietf-rats-eat-latest</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>An Entity Attestation Token (EAT) provides a signed (attested) set of claims that describe state and characteristics of an entity, typically a device like a phone or an IoT device.  These claims are used by a relying party to determine how much it wishes to trust the entity.</p>
<p>An EAT is either a CWT or JWT with some attestation-oriented claims. To a large degree, all this document does is extend CWT and JWT.</p>
<h1><a>Contributing</a></h1>
<p>TBD</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of This Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at https://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on April 19, 2020.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2019 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (https://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<ul><li>1.1.   <a href="#rfc.section.1.1">CDDL, CWT and JWT</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">Entity Overview</a>
</li>
<li>1.3.   <a href="#rfc.section.1.3">EAT Operating Models</a>
</li>
<li>1.4.   <a href="#rfc.section.1.4">What is Not Standardized</a>
</li>
<ul><li>1.4.1.   <a href="#rfc.section.1.4.1">Transmission Protocol</a>
</li>
<li>1.4.2.   <a href="#rfc.section.1.4.2">Signing Scheme</a>
</li>
</ul></ul><li>2.   <a href="#rfc.section.2">Terminology</a>
</li>
<li>3.   <a href="#rfc.section.3">The Claims Information Model</a>
</li>
<ul><li>3.1.   <a href="#rfc.section.3.1">Nonce Claim (cti and jti)</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Timestamp claim (iat)</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">Universal Entity ID Claim (ueid)</a>
</li>
<ul><li>3.3.1.   <a href="#rfc.section.3.3.1">CDDL</a>
</li>
</ul><li>3.4.   <a href="#rfc.section.3.4">Origination Claim (origination)</a>
</li>
<ul><li>3.4.1.   <a href="#rfc.section.3.4.1">CDDL</a>
</li>
</ul><li>3.5.   <a href="#rfc.section.3.5">OEM identification by IEEE (oemid)</a>
</li>
<ul><li>3.5.1.   <a href="#rfc.section.3.5.1">CDDL</a>
</li>
</ul><li>3.6.   <a href="#rfc.section.3.6">The Security Level Claim (security_level)</a>
</li>
<ul><li>3.6.1.   <a href="#rfc.section.3.6.1">CDDL</a>
</li>
</ul><li>3.7.   <a href="#rfc.section.3.7">Secure Boot and Debug Enable State Claims (boot_state)</a>
</li>
<ul><li>3.7.1.   <a href="#rfc.section.3.7.1">Secure Boot Enabled</a>
</li>
<li>3.7.2.   <a href="#rfc.section.3.7.2">Debug Disabled</a>
</li>
<li>3.7.3.   <a href="#rfc.section.3.7.3">Debug Disabled Since Boot</a>
</li>
<li>3.7.4.   <a href="#rfc.section.3.7.4">Debug Permanent Disable</a>
</li>
<li>3.7.5.   <a href="#rfc.section.3.7.5">Debug Full Permanent Disable</a>
</li>
<li>3.7.6.   <a href="#rfc.section.3.7.6">CDDL</a>
</li>
</ul><li>3.8.   <a href="#rfc.section.3.8">The Location Claim (location)</a>
</li>
<ul><li>3.8.1.   <a href="#rfc.section.3.8.1">CDDL</a>
</li>
</ul><li>3.9.   <a href="#rfc.section.3.9">The Age Claim (age)</a>
</li>
<li>3.10.   <a href="#rfc.section.3.10">The Uptime Claim (uptime)</a>
</li>
<ul><li>3.10.1.   <a href="#rfc.section.3.10.1">CDDL</a>
</li>
</ul><li>3.11.   <a href="#rfc.section.3.11">Nested EATs, the EAT Claim (nested_eat)</a>
</li>
<ul><li>3.11.1.   <a href="#rfc.section.3.11.1">CDDL</a>
</li>
</ul><li>3.12.   <a href="#rfc.section.3.12">The Submods Claim (submods)</a>
</li>
<ul><li>3.12.1.   <a href="#rfc.section.3.12.1">The submod_name Claim</a>
</li>
<li>3.12.2.   <a href="#rfc.section.3.12.2">CDDL</a>
</li>
</ul></ul><li>4.   <a href="#rfc.section.4">Data Model</a>
</li>
<ul><li>4.1.   <a href="#rfc.section.4.1">Common CDDL Types</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">CDDL for CWT-defined Claims</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">JSON</a>
</li>
<ul><li>4.3.1.   <a href="#rfc.section.4.3.1">JSON Labels</a>
</li>
<li>4.3.2.   <a href="#rfc.section.4.3.2">JSON Interoperability</a>
</li>
</ul><li>4.4.   <a href="#rfc.section.4.4">CBOR</a>
</li>
<ul><li>4.4.1.   <a href="#rfc.section.4.4.1">Labels</a>
</li>
<li>4.4.2.   <a href="#rfc.section.4.4.2">CBOR Types</a>
</li>
<li>4.4.3.   <a href="#rfc.section.4.4.3">CBOR Interoperability</a>
</li>
</ul><li>4.5.   <a href="#rfc.section.4.5">Collected CDDL</a>
</li>
</ul><li>5.   <a href="#rfc.section.5">IANA Considerations</a>
</li>
<ul><li>5.1.   <a href="#rfc.section.5.1">Reuse of CBOR Web Token (CWT) Claims Registry</a>
</li>
<ul><li>5.1.1.   <a href="#rfc.section.5.1.1">Claims Registered by This Document</a>
</li>
</ul></ul><li>6.   <a href="#rfc.section.6">Privacy Considerations</a>
</li>
<ul><li>6.1.   <a href="#rfc.section.6.1">UEID Privacy Considerations</a>
</li>
</ul><li>7.   <a href="#rfc.section.7">Security Considerations</a>
</li>
<li>8.   <a href="#rfc.references">References</a>
</li>
<ul><li>8.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>8.2.   <a href="#rfc.references.2">Informative References</a>
</li>
</ul><li>Appendix A.   <a href="#rfc.appendix.A">Examples</a>
</li>
<ul><li>A.1.   <a href="#rfc.appendix.A.1">Very Simple EAT</a>
</li>
<li>A.2.   <a href="#rfc.appendix.A.2">Example with Submodules, Nesting and Security Levels</a>
</li>
</ul><li>Appendix B.   <a href="#rfc.appendix.B">Changes from Previous Drafts</a>
</li>
<ul><li>B.1.   <a href="#rfc.appendix.B.1">From draft-mandyam-rats-eat-00</a>
</li>
</ul><li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#introduction" id="introduction">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">Remote device attestation is a fundamental service that allows a remote device such as a mobile phone, an Internet-of-Things (IoT) device, or other endpoint to prove itself to a relying party, a server or a service.  This allows the relying party to know some characteristics about the device and decide whether it trusts the device.</p>
<p id="rfc.section.1.p.2">Remote attestation is a fundamental service that can underlie other protocols and services that need to know about the trustworthiness of the device before proceeding. One good example is biometric authentication where the biometric matching is done on the device. The relying party needs to know that the device is one that is known to do biometric matching correctly.  Another example is content protection where the relying party wants to know the device will protect the data.  This generalizes on to corporate enterprises that might want to know that a device is trustworthy before allowing corporate data to be accessed by it.</p>
<p id="rfc.section.1.p.3">The notion of attestation here is large and may include, but is not limited to the following:</p>
<p></p>

<ul>
<li>Proof of the make and model of the device hardware (HW)</li>
<li>Proof of the make and model of the device processor, particularly for security-oriented chips</li>
<li>Measurement of the software (SW) running on the device</li>
<li>Configuration and state of the device</li>
<li>Environmental characteristics of the device such as its GPS location</li>
</ul>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> <a href="#cddl-cwt-and-jwt" id="cddl-cwt-and-jwt">CDDL, CWT and JWT</a>
</h1>
<p id="rfc.section.1.1.p.1">An EAT token is either a CWT as defined in <a href="#RFC8392" class="xref">[RFC8392]</a> or a JWT as defined in <a href="#RFC7519" class="xref">[RFC7519]</a>. This specification defines additional claims for entity attestation.</p>
<p id="rfc.section.1.1.p.2">This specification uses CDDL, <a href="#RFC8610" class="xref">[RFC8610]</a>, as the primary formalism to define each claim.  The implementor then interprets the CDDL to come to either the CBOR <a href="#RFC7049" class="xref">[RFC7049]</a> or JSON <a href="#ECMAScript" class="xref">[ECMAScript]</a> representation. In the case of JSON, Appendix E of <a href="#RFC8610" class="xref">[RFC8610]</a> is followed. Additional rules are given in <a href="#jsoninterop" class="xref">Section 4.3.2</a> of this document where Appendix E is insufficient.  (Note that this is not to define a general means to translate between CBOR and JSON, but only to define enough such that the claims defined in this document can be rendered unambiguously in JSON).</p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> <a href="#entity-overview" id="entity-overview">Entity Overview</a>
</h1>
<p id="rfc.section.1.2.p.1">An &#8220;entity&#8221; can be any device or device subassembly (&#8220;submodule&#8221;) that can generate its own attestation in the form of an EAT.  The attestation should be cryptographically verifiable by the EAT consumer. An EAT at the device-level can be composed of several submodule EAT&#8217;s.  It is assumed that any entity that can create an EAT does so by means of a dedicated root-of-trust (RoT).</p>
<p id="rfc.section.1.2.p.2">Modern devices such as a mobile phone have many different execution environments operating with different security levels. For example, it is common for a mobile phone to have an &#8220;apps&#8221; environment that runs an operating system (OS) that hosts a plethora of downloadable apps. It may also have a TEE (Trusted Execution Environment) that is distinct, isolated, and hosts security-oriented functionality like biometric authentication. Additionally, it may have an eSE (embedded Secure Element) - a high security chip with defenses against HW attacks that can serve as a RoT.  This device attestation format allows the attested data to be tagged at a security level from which it originates.  In general, any discrete execution environment that has an identifiable security level can be considered an entity.</p>
<h1 id="rfc.section.1.3">
<a href="#rfc.section.1.3">1.3.</a> <a href="#eat-operating-models" id="eat-operating-models">EAT Operating Models</a>
</h1>
<p id="rfc.section.1.3.p.1">At least the following three participants exist in all EAT operating models. Some operating models have additional participants.</p>
<p></p>

<dl>
<dt>The Entity.</dt>
<dd style="margin-left: 8">This is the phone, the IoT device, the sensor, the sub-assembly or such that the attestation provides information about.</dd>
<dt>The Manufacturer.</dt>
<dd style="margin-left: 8">The company that made the entity.  This may be a chip vendor, a circuit board module vendor or a vendor of finished consumer products.</dd>
<dt>The Relying Party.</dt>
<dd style="margin-left: 8">The server, service or company that makes use of the information in the EAT about the entity.</dd>
</dl>
<p id="rfc.section.1.3.p.3">In all operating models, the manufacturer provisions some secret attestation key material (AKM) into the entity during manufacturing.  This might be during the manufacturer of a chip at a fabrication facility (fab) or during final assembly of a consumer product or any time in between. This attestation key material is used for signing EATs.</p>
<p id="rfc.section.1.3.p.4">In all operating models, hardware and/or software on the entity create an EAT of the format described in this document. The EAT is always signed by the attestation key material provisioned by the manufacturer.</p>
<p id="rfc.section.1.3.p.5">In all operating models, the relying party must end up knowing that the signature on the EAT is valid and consistent with data from claims in the EAT.  This can happen in many different ways. Here are some examples.</p>
<p></p>

<ul>
<li>The EAT is transmitted to the relying party. The relying party gets corresponding key material (e.g. a root certificate) from the manufacturer. The relying party performs the verification.</li>
<li>The EAT is transmitted to the relying party. The relying party transmits the EAT to a verification service offered by the manufacturer. The server returns the validated claims.</li>
<li>The EAT is transmitted directly to a verification service, perhaps operated by the manufacturer or perhaps by another party. It verifies the EAT and makes the validated claims available to the relying party. It may even modify the claims in some way and re-sign the EAT (with a different signing key).</li>
</ul>
<p id="rfc.section.1.3.p.7">All these operating models are supported and there is no preference of one over the other. It is important to support this variety of operating models to generally facilitate deployment and to allow for some special scenarios. One special scenario has a validation service that is monetized, most likely by the manufacturer.  In another, a privacy proxy service processes the EAT before it is transmitted to the relying party. In yet another, symmetric key material is used for signing. In this case the manufacturer should perform the verification, because any release of the key material would enable a participant other than the entity to create valid signed EATs.</p>
<h1 id="rfc.section.1.4">
<a href="#rfc.section.1.4">1.4.</a> <a href="#what-is-not-standardized" id="what-is-not-standardized">What is Not Standardized</a>
</h1>
<p id="rfc.section.1.4.p.1">The following is not standardized for EAT, just the same they are not standardized for CWT or JWT.</p>
<h1 id="rfc.section.1.4.1">
<a href="#rfc.section.1.4.1">1.4.1.</a> <a href="#transmission-protocol" id="transmission-protocol">Transmission Protocol</a>
</h1>
<p id="rfc.section.1.4.1.p.1">EATs may be transmitted by any protocol the same as CWTs and JWTs. For example, they might be added in extension fields of other protocols, bundled into an HTTP header, or just transmitted as files. This flexibility is intentional to allow broader adoption. This flexibility is possible because EAT&#8217;s are self-secured with signing (and possibly additionally with encryption and anti-replay). The transmission protocol is not required to fulfill any additional security requirements.</p>
<p id="rfc.section.1.4.1.p.2">For certain devices, a direct connection may not exist between the EAT-producing device and the Relying Party. In such cases, the EAT should be protected against malicious access. The use of COSE and JOSE allows for signing and encryption of the EAT. Therefore, even if the EAT is conveyed through intermediaries between the device and Relying Party, such intermediaries cannot easily modify the EAT payload or alter the signature.</p>
<h1 id="rfc.section.1.4.2">
<a href="#rfc.section.1.4.2">1.4.2.</a> <a href="#signing-scheme" id="signing-scheme">Signing Scheme</a>
</h1>
<p id="rfc.section.1.4.2.p.1">The term &#8220;signing scheme&#8221; is used to refer to the system that includes end-end process of establishing signing attestation key material in the entity, signing the EAT, and verifying it. This might involve key IDs and X.509 certificate chains or something similar but different. The term &#8220;signing algorithm&#8221; refers just to the algorithm ID in the COSE signing structure. No particular signing algorithm or signing scheme is required by this standard.</p>
<p id="rfc.section.1.4.2.p.2">There are three main implementation issues driving this. First, secure non-volatile storage space in the entity for the attestation key material may be highly limited, perhaps to only a few hundred bits, on some small IoT chips. Second, the factory cost of provisioning key material in each chip or device may be high, with even millisecond delays adding to the cost of a chip. Third, privacy-preserving signing schemes like ECDAA (Elliptic Curve Direct Anonymous Attestation) are complex and not suitable for all use cases.</p>
<p id="rfc.section.1.4.2.p.3">Over time to faciliate interoperability, some signing schemes may be defined in EAT profiles or other documents either in the IETF or outside.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#terminology" id="terminology">Terminology</a>
</h1>
<p id="rfc.section.2.p.1">The key words &#8220;MUST&#8221;, &#8220;MUST NOT&#8221;, &#8220;REQUIRED&#8221;, &#8220;SHALL&#8221;, &#8220;SHALL NOT&#8221;, &#8220;SHOULD&#8221;, &#8220;SHOULD NOT&#8221;, &#8220;RECOMMENDED&#8221;, &#8220;NOT RECOMMENDED&#8221;, &#8220;MAY&#8221;, and &#8220;OPTIONAL&#8221; in this document are to be interpreted as described in BCP 14 <a href="#RFC2119" class="xref">[RFC2119]</a> <a href="#RFC8174" class="xref">[RFC8174]</a> when, and only when, they appear in all capitals, as shown here.</p>
<p id="rfc.section.2.p.2">This document reuses terminology from JWT <a href="#RFC7519" class="xref">[RFC7519]</a>, COSE <a href="#RFC8152" class="xref">[RFC8152]</a>, and CWT <a href="#RFC8392" class="xref">[RFC8392]</a>.</p>
<p></p>

<dl>
<dt>Claim Name.</dt>
<dd style="margin-left: 8">The human-readable name used to identify a claim.</dd>
<dt>Claim Key.</dt>
<dd style="margin-left: 8">The CBOR map key or JSON name used to identify a claim.</dd>
<dt>Claim Value.</dt>
<dd style="margin-left: 8">The CBOR map or JSON object value representing the value of the claim.</dd>
<dt>CWT Claims Set.</dt>
<dd style="margin-left: 8">The CBOR map or JSON object that contains the claims conveyed by the CWT or JWT.</dd>
<dt>Attestation Key Material (AKM).</dt>
<dd style="margin-left: 8">The key material used to sign the EAT token. If it is done symmetrically with HMAC, then this is a simple symmetric key.  If it is done with ECC, such as an IEEE DevID <a href="#IDevID" class="xref">[IDevID]</a>, then this is the private part of the EC key pair. If ECDAA is used, (e.g., as used by Enhanced Privacy ID, i.e. EPID) then it is the key material needed for ECDAA.</dd>
</dl>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#the-claims-information-model" id="the-claims-information-model">The Claims Information Model</a>
</h1>
<p id="rfc.section.3.p.1">This section describes new claims defined for attestation. It also mentions several claims defined by CWT and JWT that are particularly important for EAT.</p>
<p id="rfc.section.3.p.2">Note also: * Any claim defined for CWT or JWT may be used in an EAT including those in the CWT <a href="#IANA.CWT.Claims" class="xref">[IANA.CWT.Claims]</a> and JWT IANA <a href="#IANA.JWT.Claims" class="xref">[IANA.JWT.Claims]</a> claims registries.</p>
<p></p>

<ul>
<li>All claims are optional</li>
<li>No claims are mandatory</li>
<li>All claims that are not understood by implementations MUST be ignored</li>
</ul>
<p id="rfc.section.3.p.4">CDDL along with text descriptions is used to define the information model.  Each claim is defined as a CDDL group (the group is a general aggregation and type definition feature of CDDL). In the data model, described in the <a href="#datamodel" class="xref">Section 4</a>, the CDDL groups turn into CBOR map entries and JSON name/value pairs.</p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#nonce-claim-cti-and-jti" id="nonce-claim-cti-and-jti">Nonce Claim (cti and jti)</a>
</h1>
<p id="rfc.section.3.1.p.1">All EATs should have a nonce to prevent replay attacks. The nonce is generated by the relying party, provided to the entity, and included in the token. Note that intrinsically by the nature of a nonce no security is needed for its transport.</p>
<p id="rfc.section.3.1.p.2">CWT defines the &#8220;cti&#8221; claim. JWT defines the &#8220;jti&#8221; claim. These carry the nonce in an EAT.</p>
<p id="rfc.section.3.1.p.3">TODO: what about the JWT claim &#8220;nonce&#8221;?</p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> <a href="#timestamp-claim-iat" id="timestamp-claim-iat">Timestamp claim (iat)</a>
</h1>
<p id="rfc.section.3.2.p.1">The &#8220;iat&#8221; claim defined in CWT and JWT is used to indicate the date-of-creation of the token.</p>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> <a href="#universal-entity-id-claim-ueid" id="universal-entity-id-claim-ueid">Universal Entity ID Claim (ueid)</a>
</h1>
<p id="rfc.section.3.3.p.1">UEID&#8217;s identify individual manufactured entities / devices such as a mobile phone, a water meter, a Bluetooth speaker or a networked security camera. It may identify the entire device or a submodule or subsystem. It does not identify types, models or classes of devices. It is akin to a serial number, though it does not have to be sequential.</p>
<p id="rfc.section.3.3.p.2">UEID&#8217;s must be universally and globally unique across manufacturers and countries. UEIDs must also be unique across protocols and systems, as tokens are intended to be embedded in many different protocols and systems. No two products anywhere, even in completely different industries made by two different manufacturers in two different countries should have the same UEID (if they are not global and universal in this way, then relying parties receiving them will have to track other characteristics of the device to keep devices distinct between manufacturers).</p>
<p id="rfc.section.3.3.p.3">There are privacy considerations for UEID&#8217;s. See <a href="#ueidprivacyconsiderations" class="xref">Section 6.1</a>.</p>
<p id="rfc.section.3.3.p.4">The UEID should be permanent. It should never change for a given device / entity. In addition, it should not be reprogrammable.  UEID&#8217;s are variable length. The recommended maximum is 33 bytes (1 type byte and 256 bits). The recommended minimum is 17 bytes (1 type and 128 bits) because fewer bytes endanger the universal uniqueness.</p>
<p id="rfc.section.3.3.p.5">When the entity constructs the UEID, the first byte is a type and the following bytes the ID for that type. Several types are allowed to accommodate different industries and different manufacturing processes and to give options to avoid paying fees for certain types of manufacturer registrations.</p>
<p id="rfc.section.3.3.p.6">Creation of new types requires a Standards Action <a href="#RFC8126" class="xref">[RFC8126]</a>.</p>
<div id="rfc.table.1"></div>
<div id="ueid-types-table"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>UEID Composition Types</caption>
<thead><tr>
<th class="left">Type Byte</th>
<th class="left">Type Name</th>
<th class="left">Specification</th>
</tr></thead>
<tbody>
<tr>
<td class="left">0x01</td>
<td class="left">RAND</td>
<td class="left">This is a 128- to 256-bit random number generated once and stored in the device. This may be constructed by concatenating enough identifiers to be universally unique and then feeding the concatenation through a cryptographic hash function. It may also be a cryptographic quality random number generate once at the beginning of the life of the device and stored.</td>
</tr>
<tr>
<td class="left">0x02</td>
<td class="left">IEEE EUI</td>
<td class="left">This makes use of the IEEE company identification registry. An EUI is made up of an OUI and OUI-36 or a CID, different registered company identifiers, and some unique per-device identifier. EUIs are often the same as or similar to MAC addresses. (Note that while devices with multiple network interfaces may have multiple MAC addresses, there is only one UEID for a device) TODO: normative references to IEEE.</td>
</tr>
<tr>
<td class="left">0x03</td>
<td class="left">IMEI</td>
<td class="left">This is a 14-digit identifier consisting of an 8-digit Type Allocation Code and a 6-digit serial number allocated by the manufacturer, which SHALL be encoded as a binary integer over 48 bits. The IMEI value encoded SHALL NOT include Luhn checksum or SVN information.</td>
</tr>
<tr>
<td class="left">0x04</td>
<td class="left">EUI-48</td>
<td class="left">This is a 48-bit identifier formed by concatenating the 24-bit OUI with a 24-bit identifier assigned by the organisation that purchased the OUI.</td>
</tr>
<tr>
<td class="left">0x05</td>
<td class="left">EUI-60</td>
<td class="left">This is a 60-bit identifier formed by concatenating the 24-bit OUI with a 36-bit identifier assigned by the organisation that purchased the OUI.</td>
</tr>
<tr>
<td class="left">0x06</td>
<td class="left">EUI-64</td>
<td class="left">This is a 64-bit identifier formed by concatenating the 24-bit OUI with a 40-bit identifier assigned by the organisation that purchased the OUI.</td>
</tr>
</tbody>
</table>
<p id="rfc.section.3.3.p.7">UEID&#8217;s are not designed for direct use by humans (e.g., printing on the case of a device), so no textual representation is defined.</p>
<p id="rfc.section.3.3.p.8">The consumer (the relying party) of a UEID MUST treat a UEID as a completely opaque string of bytes and not make any use of its internal structure. For example, they should not use the OUI part of a type 0x02 UEID to identify the manufacturer of the device. Instead they should use the OUI claim that is defined elsewhere. The reasons for this are:</p>
<p></p>

<ul>
<li>UEIDs types may vary freely from one manufacturer to the next.</li>
<li>New types of UEIDs may be created. For example, a type 0x07 UEID may be created based on some other manufacturer registration scheme.</li>
<li>Device manufacturers are allowed to change from one type of UEID to another anytime they want. For example, they may find they can optimize their manufacturing by switching from type 0x01 to type 0x02 or vice versa.  The main requirement on the manufacturer is that UEIDs be universally unique.</li>
</ul>
<h1 id="rfc.section.3.3.1">
<a href="#rfc.section.3.3.1">3.3.1.</a> <a href="#cddl" id="cddl">CDDL</a>
</h1>
<pre>
 ueid_claim = (
 ueid: bstr )
</pre>
<h1 id="rfc.section.3.4">
<a href="#rfc.section.3.4">3.4.</a> <a href="#origination-claim-origination" id="origination-claim-origination">Origination Claim (origination)</a>
</h1>
<p id="rfc.section.3.4.p.1">This claim describes the parts of the device or entity that are creating the EAT. Often it will be tied back to the device or chip manufacturer. The following table gives some examples:</p>
<table cellpadding="3" cellspacing="0" class="tt full center">
<thead><tr>
<th class="left">Name</th>
<th class="left">Description</th>
</tr></thead>
<tbody>
<tr>
<td class="left">Acme-TEE</td>
<td class="left">The EATs are generated in the TEE authored and configured by &#8220;Acme&#8221;</td>
</tr>
<tr>
<td class="left">Acme-TPM</td>
<td class="left">The EATs are generated in a TPM manufactured by &#8220;Acme&#8221;</td>
</tr>
<tr>
<td class="left">Acme-Linux-Kernel</td>
<td class="left">The EATs are generated in a Linux kernel configured and shipped by &#8220;Acme&#8221;</td>
</tr>
<tr>
<td class="left">Acme-TA</td>
<td class="left">The EATs are generated in a Trusted Application (TA) authored by &#8220;Acme&#8221;</td>
</tr>
</tbody>
</table>
<p id="rfc.section.3.4.p.2">TODO: consider a more structure approach where the name and the URI and other are in separate fields.</p>
<p id="rfc.section.3.4.p.3">TODO: This needs refinement. It is somewhat parallel to issuer claim in CWT in that it describes the authority that created the token.</p>
<h1 id="rfc.section.3.4.1">
<a href="#rfc.section.3.4.1">3.4.1.</a> <a href="#cddl-1" id="cddl-1">CDDL</a>
</h1>
<pre>
origination_claim = (
origination: string_or_uri )
</pre>
<h1 id="rfc.section.3.5">
<a href="#rfc.section.3.5">3.5.</a> <a href="#oem-identification-by-ieee-oemid" id="oem-identification-by-ieee-oemid">OEM identification by IEEE (oemid)</a>
</h1>
<p id="rfc.section.3.5.p.1">The IEEE operates a global registry for MAC addresses and company IDs.  This claim uses that database to identify OEMs. The contents of the claim may be either an IEEE MA-L, MA-M, MA-S or an IEEE CID <a href="#IEEE.RA" class="xref">[IEEE.RA]</a>.  An MA-L, formerly known as an OUI, is a 24-bit value used as the first half of a MAC address. MA-M similarly is a 28-bit value uses as the first part of a MAC address, and MA-S, formerly known as OUI-36, a 36-value.  Many companies already have purchased one of these. A CDI is also a 24-bit value from the same space as an MA-L, but not for use as a MAC address.  IEEE has published Guidelines for Use of EUI, OUI, and CID <a href="#OUI.Guide" class="xref">[OUI.Guide]</a> and provides a lookup services <a href="#OUI.Lookup" class="xref">[OUI.Lookup]</a></p>
<p id="rfc.section.3.5.p.2">Companies that have more than one of these IDs or MAC address blocks should pick one and prefer that for all their devices.</p>
<p id="rfc.section.3.5.p.3">Commonly, these are expressed in Hexadecimal Representation <a href="#IEEE.802-2001" class="xref">[IEEE.802-2001]</a> also called the Canonical format. When this claim is encoded this is the byte order used.</p>
<p id="rfc.section.3.5.p.4">These claims use the hex_bstr type. It encodes as a binary byte string in CDDL for compactness and a hexadecimal text in JSON for readability. The JSON representation is not base64 encoded as used for other binary data.</p>
<h1 id="rfc.section.3.5.1">
<a href="#rfc.section.3.5.1">3.5.1.</a> <a href="#cddl-2" id="cddl-2">CDDL</a>
</h1>
<pre>
oemid_claim = (
oemid: hex_bstr )
</pre>
<h1 id="rfc.section.3.6">
<a href="#rfc.section.3.6">3.6.</a> <a href="#the-security-level-claim-securitylevel" id="the-security-level-claim-securitylevel">The Security Level Claim (security_level)</a>
</h1>
<p id="rfc.section.3.6.p.1">EATs have a claim that roughly characterizes the device / entities ability to defend against attacks aimed at capturing the signing key, forging claims and at forging EATs. This is done by roughly defining four security levels as described below. This is similar to the security levels defined in the Metadata Service defined by the Fast Identity Online (FIDO) Alliance (TODO: reference).</p>
<p id="rfc.section.3.6.p.2">These claims describe security environment and countermeasures available on the end-entity / client device where the attestation key reside and the claims originate.</p>
<p></p>

<dl>
<dt>1 &#8211; Unrestricted</dt>
<dd style="margin-left: 8">There is some expectation that implementor will protect the attestation signing keys at this level. Otherwise the EAT provides no meaningful security assurances.</dd>
<dt>2&#8211; Restricted</dt>
<dd style="margin-left: 8">Entities at this level should not be general-purpose operating environments that host features such as app download systems, web browsers and complex productivity applications.  It is akin to the Secure Restricted level (see below) without the security orientation. Examples include a Wi-Fi subsystem, an IoT camera, or sensor device.</dd>
<dt>3 &#8211; Secure Restricted</dt>
<dd style="margin-left: 8">Entities at this level must meet the criteria defined by FIDO Allowed Restricted Operating Environments (TODO: reference). Examples include TEE&#8217;s and schemes using virtualization-based security. Like the FIDO security goal, security at this level is aimed at defending well against large-scale network / remote attacks against the device.</dd>
<dt>4 &#8211; Hardware</dt>
<dd style="margin-left: 8">Entities at this level must include substantial defense against physical or electrical attacks against the device itself.  It is assumed any potential attacker has captured the device and can disassemble it. Example include TPMs and Secure Elements.</dd>
</dl>
<p id="rfc.section.3.6.p.4">This claim is not intended as a replacement for a proper end-device security certification schemes such as those based on FIPS (TODO: reference) or those based on Common Criteria (TODO: reference). The claim made here is solely a self-claim made by the Entity Originator.</p>
<h1 id="rfc.section.3.6.1">
<a href="#rfc.section.3.6.1">3.6.1.</a> <a href="#cddl-3" id="cddl-3">CDDL</a>
</h1>
<pre>
security_level_type = (
unrestricted: 1,
restricted: 2,
secure_restricted: 3,
hardware: 4
)

security_level_claim = (
security_level: security_level_type )
</pre>
<h1 id="rfc.section.3.7">
<a href="#rfc.section.3.7">3.7.</a> <a href="#secure-boot-and-debug-enable-state-claims-bootstate" id="secure-boot-and-debug-enable-state-claims-bootstate">Secure Boot and Debug Enable State Claims (boot_state)</a>
</h1>
<p id="rfc.section.3.7.p.1">This claim is an array of five Boolean values indicating the boot and debug state of the entity.</p>
<h1 id="rfc.section.3.7.1">
<a href="#rfc.section.3.7.1">3.7.1.</a> <a href="#secure-boot-enabled" id="secure-boot-enabled">Secure Boot Enabled</a>
</h1>
<p id="rfc.section.3.7.1.p.1">This indicates whether secure boot is enabled either for an entire device or an individual submodule.  If it appears at the device level, then this means that secure boot is enabled for all submodules.  Secure boot enablement allows a secure boot loader to authenticate software running either in a device or a submodule prior allowing execution.</p>
<h1 id="rfc.section.3.7.2">
<a href="#rfc.section.3.7.2">3.7.2.</a> <a href="#debug-disabled" id="debug-disabled">Debug Disabled</a>
</h1>
<p id="rfc.section.3.7.2.p.1">This indicates whether debug capabilities are disabled for an entity (i.e. value of &#8216;true&#8217;).  Debug disablement is considered a prerequisite before an entity is considered operational.</p>
<h1 id="rfc.section.3.7.3">
<a href="#rfc.section.3.7.3">3.7.3.</a> <a href="#debug-disabled-since-boot" id="debug-disabled-since-boot">Debug Disabled Since Boot</a>
</h1>
<p id="rfc.section.3.7.3.p.1">This claim indicates whether debug capabilities for the entity were not disabled in any way since boot (i.e. value of &#8216;true&#8217;).</p>
<h1 id="rfc.section.3.7.4">
<a href="#rfc.section.3.7.4">3.7.4.</a> <a href="#debug-permanent-disable" id="debug-permanent-disable">Debug Permanent Disable</a>
</h1>
<p id="rfc.section.3.7.4.p.1">This claim indicates whether debug capabilities for the entity are permanently disabled (i.e. value of &#8216;true&#8217;).  This value can be set to &#8216;true&#8217; also if only the manufacturer is allowed to enabled debug, but the end user is not.</p>
<h1 id="rfc.section.3.7.5">
<a href="#rfc.section.3.7.5">3.7.5.</a> <a href="#debug-full-permanent-disable" id="debug-full-permanent-disable">Debug Full Permanent Disable</a>
</h1>
<p id="rfc.section.3.7.5.p.1">This claim indicates whether debug capabilities for the entity are permanently disabled (i.e. value of &#8216;true&#8217;).  This value can only be set to &#8216;true&#8217; if no party can enable debug capabilities for the entity. Often this is implemented by blowing a fuse on a chip as fuses cannot be restored once blown.</p>
<h1 id="rfc.section.3.7.6">
<a href="#rfc.section.3.7.6">3.7.6.</a> <a href="#cddl-4" id="cddl-4">CDDL</a>
</h1>
<pre>
boot_state_type = [
    secure_boot_enabled=&gt; bool,
    debug_disabled=&gt; bool,
    debug_disabled_since_boot=&gt; bool,
    debug_permanent_disable=&gt; bool,
    debug_full_permanent_disable=&gt; bool
]

boot_state_claim = (
boot_state: boot_state_type
)
</pre>
<h1 id="rfc.section.3.8">
<a href="#rfc.section.3.8">3.8.</a> <a href="#the-location-claim-location" id="the-location-claim-location">The Location Claim (location)</a>
</h1>
<p id="rfc.section.3.8.p.1">The location claim is a CBOR-formatted object that describes the location of the device entity from which the attestation originates.  It is comprised of a map of additional sub claims that represent the actual location coordinates (latitude, longitude and altitude).  The location coordinate claims are consistent with the WGS84 coordinate system <a href="#WGS84" class="xref">[WGS84]</a>.  In addition, a sub claim providing the estimated accuracy of the location measurement is defined.</p>
<h1 id="rfc.section.3.8.1">
<a href="#rfc.section.3.8.1">3.8.1.</a> <a href="#cddl-5" id="cddl-5">CDDL</a>
</h1>
<pre>
location_type = {
    latitude =&gt; number,
    longitude =&gt; number,
    altitude =&gt; number,
    accuracy =&gt; number,
    altitude_accuracy =&gt; number,
    heading =&gt; number,
    speed =&gt; number
}

location_claim = (
location: location_type )
</pre>
<h1 id="rfc.section.3.9">
<a href="#rfc.section.3.9">3.9.</a> <a href="#the-age-claim-age" id="the-age-claim-age">The Age Claim (age)</a>
</h1>
<p id="rfc.section.3.9.p.1">The &#8220;age&#8221; claim contains a value that represents the number of seconds that have elapsed since the token was created, measurement was made, or location was obtained.  Typical attestable values are sent as soon as they are obtained.  However, in the case that such a value is buffered and sent at a later time and a sufficiently accurate time reference is unavailable for creation of a timestamp, then the age claim is provided.</p>
<pre>
age_claim = (
age: uint)
</pre>
<h1 id="rfc.section.3.10">
<a href="#rfc.section.3.10">3.10.</a> <a href="#the-uptime-claim-uptime" id="the-uptime-claim-uptime">The Uptime Claim (uptime)</a>
</h1>
<p id="rfc.section.3.10.p.1">The &#8220;uptime&#8221; claim contains a value that represents the number of seconds that have elapsed since the entity or submod was last booted.</p>
<h1 id="rfc.section.3.10.1">
<a href="#rfc.section.3.10.1">3.10.1.</a> <a href="#cddl-6" id="cddl-6">CDDL</a>
</h1>
<pre>
uptime_claim = (
uptime: uint )
</pre>
<h1 id="rfc.section.3.11">
<a href="#rfc.section.3.11">3.11.</a> <a href="#nested-eats-the-eat-claim-nestedeat" id="nested-eats-the-eat-claim-nestedeat">Nested EATs, the EAT Claim (nested_eat)</a>
</h1>
<p id="rfc.section.3.11.p.1">It is allowed for one EAT to be embedded in another. This is for complex devices that have more than one subsystem capable of generating an EAT. For example, one might be the device-wide EAT that is low to medium security and another from a Secure Element or similar that is high security.</p>
<p id="rfc.section.3.11.p.2">The contents of the &#8220;nested_eat&#8221; claim must be a fully signed, optionally encrypted, EAT token.</p>
<h1 id="rfc.section.3.11.1">
<a href="#rfc.section.3.11.1">3.11.1.</a> <a href="#cddl-7" id="cddl-7">CDDL</a>
</h1>
<pre>
nested_eat_claim = (
nested_eat: nested_eat_type)
</pre>
<p id="rfc.section.3.11.1.p.1">A nested_eat_type is defined in words rather than CDDL. It is either a full CWT or JWT including the COSE or JOSE signing.</p>
<h1 id="rfc.section.3.12">
<a href="#rfc.section.3.12">3.12.</a> <a href="#the-submods-claim-submods" id="the-submods-claim-submods">The Submods Claim (submods)</a>
</h1>
<p id="rfc.section.3.12.p.1">Some devices are complex, having many subsystems or submodules.  A mobile phone is a good example. It may have several connectivity submodules for communications (e.g., Wi-Fi and cellular). It may have subsystems for low-power audio and video playback. It may have one or more security-oriented subsystems like a TEE or a Secure Element.</p>
<p id="rfc.section.3.12.p.2">The claims for each these can be grouped together in a submodule.</p>
<p id="rfc.section.3.12.p.3">Specifically, the &#8220;submods&#8221; claim is an array. Each item in the array is a CBOR map containing all the claims for a particular submodule.</p>
<p id="rfc.section.3.12.p.4">The security level of the submod is assumed to be at the same level as the main entity unless there is a security level claim in that submodule indicating otherwise. The security level of a submodule can never be higher (more secure) than the security level of the EAT it is a part of.</p>
<h1 id="rfc.section.3.12.1">
<a href="#rfc.section.3.12.1">3.12.1.</a> <a href="#the-submodname-claim" id="the-submodname-claim">The submod_name Claim</a>
</h1>
<p id="rfc.section.3.12.1.p.1">Each submodule should have a submod_name claim that is descriptive name. This name should be the CBOR txt type.</p>
<h1 id="rfc.section.3.12.2">
<a href="#rfc.section.3.12.2">3.12.2.</a> <a href="#cddl-8" id="cddl-8">CDDL</a>
</h1>
<p id="rfc.section.3.12.2.p.1">In the following a generic_claim_type is any CBOR map entry or JSON name/value pair.</p>
<pre>
submod_name_type = (
submod_name: tstr )

submods_type = [ * submod_claims ]

submod_claims = {
    submod_name_type,
    * generic_claim_type
}

submods_claim = (
submods: submod_type )
</pre>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#datamodel" id="datamodel">Data Model</a>
</h1>
<p id="rfc.section.4.p.1">This makes use of the types defined in  CDDL Appendix D, Standard Prelude.</p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#common-cddl-types" id="common-cddl-types">Common CDDL Types</a>
</h1>
<pre>
string_or_uri = #6.32(tstr) / tstr; See JSON section below for JSON encoding of string_or_uri
</pre>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> <a href="#cddl-for-cwt-defined-claims" id="cddl-for-cwt-defined-claims">CDDL for CWT-defined Claims</a>
</h1>
<p id="rfc.section.4.2.p.1">This section provides CDDL for the claims defined in CWT. It is non-normative as <a href="#RFC8392" class="xref">[RFC8392]</a> is the authoritative definition of these claims.</p>
<pre>
cwt_claim = (
    issuer_claim //
    subject_claim //
    audience_claim //
    expiration_claim //
    not_before_claim //
    issued_at_calim //
    cwt_id_claim
)

issuer_claim = (
issuer: string_or_uri )

subject_claim = (
subject: string_or_uri )

audience_claim = (
audience: string_or_uri )

expiration_claim = (
expiration: time )

not_before_claim = (
not_before: time )

issued_at_calim = (
issued_at: time )

cwt_id_claim = (
cwt_id: bstr )

issuer = 1
subject = 2
audience = 3
expiration = 4
not_before = 5
issued_at = 6
cwt_id = 7
</pre>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> <a href="#json" id="json">JSON</a>
</h1>
<h1 id="rfc.section.4.3.1">
<a href="#rfc.section.4.3.1">4.3.1.</a> <a href="#json-labels" id="json-labels">JSON Labels</a>
</h1>
<pre>
ueid = "ueid"
origination = "origination"
oemid = "oemid"
security_level = "security_level" 
boot_state = "boot_state"
location = "location"
age = "age"
uptime = "uptime"
nested_eat = "nested_eat"
submods = "submods"

latitude = "lat""
longitude = "long""
altitude = "alt"
accuracy = "accry"
altitude_accuracy = "alt_accry"
heading = "heading"
speed = "speed"
</pre>
<h1 id="rfc.section.4.3.2">
<a href="#rfc.section.4.3.2">4.3.2.</a> <a href="#jsoninterop" id="jsoninterop">JSON Interoperability</a>
</h1>
<p id="rfc.section.4.3.2.p.1">JSON should be encoded per RFC 8610 Appendix E. In addition, the following CDDL types are encoded in JSON as follows:</p>
<p></p>

<ul>
<li>bstr &#8211; must be base64url encoded</li>
<li>time &#8211; must be encoded as NumericDate as described section 2 of <a href="#RFC7519" class="xref">[RFC7519]</a>.</li>
<li>string_or_uri &#8211; must be encoded as StringOrURI as described section 2 of <a href="#RFC7519" class="xref">[RFC7519]</a>.</li>
<li>hex_bstr &#8211; encoded as hexadecimal text separated by &#8220;:&#8221; or &#8220;-&#8220;. For example &#8220;&#8220;AC-DE-48-23&#8221; or &#8220;&#8220;AC:DE:48:23&#8221;</li>
</ul>
<h1 id="rfc.section.4.4">
<a href="#rfc.section.4.4">4.4.</a> <a href="#cbor" id="cbor">CBOR</a>
</h1>
<h1 id="rfc.section.4.4.1">
<a href="#rfc.section.4.4.1">4.4.1.</a> <a href="#labels" id="labels">Labels</a>
</h1>
<pre>
ueid = 8
origination = 9
oemid = 10
security_level = 11
boot_state = 12
location = 13
age = 14
uptime = 15
nested_eat = 16
submods = 17
submod_name = 18

latitude = 1
longitude = 2
altitude = 3
accuracy = 4
altitude_accuracy = 5
heading = 6
speed = 7
</pre>
<h1 id="rfc.section.4.4.2">
<a href="#rfc.section.4.4.2">4.4.2.</a> <a href="#cbor-types" id="cbor-types">CBOR Types</a>
</h1>
<p></p>

<ul><li>hex_bstr &#8211; This is encoded as a standard CBOR byte string.</li></ul>
<h1 id="rfc.section.4.4.3">
<a href="#rfc.section.4.4.3">4.4.3.</a> <a href="#cbor-interoperability" id="cbor-interoperability">CBOR Interoperability</a>
</h1>
<p id="rfc.section.4.4.3.p.1">Variations in the CBOR serializations supported in CBOR encoding and decoding are allowed and suggests that CBOR-based protocols specify how this variation is handled. This section specifies what formats MUST be supported in order to achieve interoperability.</p>
<p id="rfc.section.4.4.3.p.2">The assumption is that the entity is likely to be a constrained device and relying party is likely to be a very capable server. The approach taken is that the entity generating the token can use whatever encoding it wants, specifically encodings that are easier to implement such as indefinite lengths. The relying party receiving the token must support decoding all encodings.</p>
<p id="rfc.section.4.4.3.p.3">These rules cover all types used in the claims in this document. They also are recommendations for additional claims.</p>
<p id="rfc.section.4.4.3.p.4">Canonical CBOR encoding, Preferred Serialization and Deterministically Encoded CBOR are explicitly NOT required as they would place an unnecessary burden on the entity implementation, particularly if the entity implementation is implemented in hardware.</p>
<p></p>

<ul>
<li>Integer Encoding (major type 0, 1) &#8211; The entity may use any integer encoding allowed by CBOR. The server MUST accept all integer encodings allowed by CBOR.</li>
<li>String Encoding (major type 2 and 3) &#8211; The entity can use any string encoding allowed by CBOR including indefinite lengths. It may also encode the lengths of strings in any way allowed by CBOR. The server must accept all string encodings.</li>
<li>Major type 2, bstr, SHOULD be have tag 21 to indicate conversion to base64url in case that conversion is performed.</li>
<li>Map and Array Encoding (major type 4 and 5) &#8211; The entity can use any array or map encoding allowed by CBOR including indefinite lengths. Sorting of map keys is not required. Duplicate map keys are not allowed. The server must accept all array and map encodings. The server may reject maps with duplicate map keys.</li>
<li>Date and Time &#8211; The entity should send dates as tag 1 encoded as 64-bit or 32-bit integers. The entity may not send floating-point dates. The server must support tag 1 epoch-based dates encoded as 64-bit or 32-bit integers. The entity may send tag 0 dates, however tag 1 is preferred.  The server must support tag 0 UTC dates.</li>
<li>URIs &#8211; URIs should be encoded as text strings and marked with tag 32.</li>
<li>Floating Point &#8211; The entity may use any floating-point encoding. The relying party must support decoding of all types of floating-point.</li>
<li>Other types &#8211; Use of Other types like bignums, regular expressions and such, SHOULD NOT be used. The server MAY support them but is not required to so interoperability is not guaranteed.</li>
</ul>
<h1 id="rfc.section.4.5">
<a href="#rfc.section.4.5">4.5.</a> <a href="#collected-cddl" id="collected-cddl">Collected CDDL</a>
</h1>
<p id="rfc.section.4.5.p.1">A generic_claim is any CBOR map entry or JSON name/value pair.</p>
<pre>
eat_claims = {  ; the top-level payload that is signed using COSE or JOSE
        * claim
}

claim = (
    ueid_claim //
    origination_claim //
    oemid_claim //
    security_level_claim //
    boot_state_claim //
    location_claim //
    age_claim //
    uptime_claim //
    nested_eat_claim //
    cwt_claim //
    generic_claim_type //
    )
</pre>
<p id="rfc.section.4.5.p.2">TODO: copy the rest of the CDDL here (wait until the CDDL is more settled so as to avoid copying multiple times)</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#iana-considerations" id="iana-considerations">IANA Considerations</a>
</h1>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> <a href="#reuse-of-cbor-web-token-cwt-claims-registry" id="reuse-of-cbor-web-token-cwt-claims-registry">Reuse of CBOR Web Token (CWT) Claims Registry</a>
</h1>
<p id="rfc.section.5.1.p.1">Claims defined for EAT are compatible with those of CWT so the CWT Claims Registry is re used. No new IANA registry is created. All EAT claims should be registered in the CWT and JWT Claims Registries.</p>
<h1 id="rfc.section.5.1.1">
<a href="#rfc.section.5.1.1">5.1.1.</a> <a href="#claims-registered-by-this-document" id="claims-registered-by-this-document">Claims Registered by This Document</a>
</h1>
<p></p>

<ul>
<li>Claim Name: UEID</li>
<li>Claim Description: The Universal Entity ID</li>
<li>JWT Claim Name: N/A</li>
<li>Claim Key: 8</li>
<li>Claim Value Type(s): byte string</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): <strong>this document</strong>
</li>
</ul>
<p id="rfc.section.5.1.1.p.2">TODO: add the rest of the claims in here</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#privacyconsiderations" id="privacyconsiderations">Privacy Considerations</a>
</h1>
<p id="rfc.section.6.p.1">Certain EAT claims can be used to track the owner of an entity and therefore, implementations should consider providing privacy-preserving options dependent on the intended usage of the EAT.  Examples would include suppression of location claims for EAT&#8217;s provided to unauthenticated consumers.</p>
<h1 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> <a href="#ueidprivacyconsiderations" id="ueidprivacyconsiderations">UEID Privacy Considerations</a>
</h1>
<p id="rfc.section.6.1.p.1">A UEID is usually not privacy-preserving. Any set of relying parties that receives tokens that happen to be from a single device will be able to know the tokens are all from the same device and be able to track the device. Thus, in many usage situations ueid violates governmental privacy regulation. In other usage situations UEID will not be allowed for certain products like browsers that give privacy for the end user. It will often be the case that tokens will not have a UEID for these reasons.</p>
<p id="rfc.section.6.1.p.2">There are several strategies that can be used to still be able to put UEID&#8217;s in tokens:</p>
<p></p>

<ul>
<li>The device obtains explicit permission from the user of the device to use the UEID. This may be through a prompt. It may also be through a license agreement.  For example, agreements for some online banking and brokerage services might already cover use of a UEID.</li>
<li>The UEID is used only in a particular context or particular use case. It is used only by one relying party.</li>
<li>The device authenticates the relying party and generates a derived UEID just for that particular relying party.  For example, the relying party could prove their identity cryptographically to the device, then the device generates a UEID just for that relying party by hashing a proofed relying party ID with the main device UEID.</li>
</ul>
<p id="rfc.section.6.1.p.4">Note that some of these privacy preservation strategies result in multiple UEIDs per device. Each UEID is used in a different context, use case or system on the device. However, from the view of the relying party, there is just one UEID and it is still globally universal across manufacturers.</p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#securitycons" id="securitycons">Security Considerations</a>
</h1>
<p id="rfc.section.7.p.1">TODO: Perhaps this can be the same as CWT / COSE, but not sure yet because it involves so much entity / device security that those do not.</p>
<h1 id="rfc.references">
<a href="#rfc.references">8.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">8.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="IANA.CWT.Claims">[IANA.CWT.Claims]</b></td>
<td class="top">
<a>IANA</a>, "<a href="http://www.iana.org/assignments/cwt">CBOR Web Token (CWT) Claims</a>", n.d..</td>
</tr>
<tr>
<td class="reference"><b id="IANA.JWT.Claims">[IANA.JWT.Claims]</b></td>
<td class="top">
<a>IANA</a>, "<a href="https://www.iana.org/assignments/jwt">JSON Web Token (JWT) Claims</a>", n.d..</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a>Bradner, S.</a>, "<a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7049">[RFC7049]</b></td>
<td class="top">
<a>Bormann, C.</a> and <a>P. Hoffman</a>, "<a href="https://tools.ietf.org/html/rfc7049">Concise Binary Object Representation (CBOR)</a>", RFC 7049, DOI 10.17487/RFC7049, October 2013.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7519">[RFC7519]</b></td>
<td class="top">
<a>Jones, M.</a>, <a>Bradley, J.</a> and <a>N. Sakimura</a>, "<a href="https://tools.ietf.org/html/rfc7519">JSON Web Token (JWT)</a>", RFC 7519, DOI 10.17487/RFC7519, May 2015.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8126">[RFC8126]</b></td>
<td class="top">
<a>Cotton, M.</a>, <a>Leiba, B.</a> and <a>T. Narten</a>, "<a href="https://tools.ietf.org/html/rfc8126">Guidelines for Writing an IANA Considerations Section in RFCs</a>", BCP 26, RFC 8126, DOI 10.17487/RFC8126, June 2017.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8152">[RFC8152]</b></td>
<td class="top">
<a>Schaad, J.</a>, "<a href="https://tools.ietf.org/html/rfc8152">CBOR Object Signing and Encryption (COSE)</a>", RFC 8152, DOI 10.17487/RFC8152, July 2017.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8174">[RFC8174]</b></td>
<td class="top">
<a>Leiba, B.</a>, "<a href="https://tools.ietf.org/html/rfc8174">Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</a>", BCP 14, RFC 8174, DOI 10.17487/RFC8174, May 2017.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8392">[RFC8392]</b></td>
<td class="top">
<a>Jones, M.</a>, <a>Wahlstroem, E.</a>, <a>Erdtman, S.</a> and <a>H. Tschofenig</a>, "<a href="https://tools.ietf.org/html/rfc8392">CBOR Web Token (CWT)</a>", RFC 8392, DOI 10.17487/RFC8392, May 2018.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8610">[RFC8610]</b></td>
<td class="top">
<a>Birkholz, H.</a>, <a>Vigano, C.</a> and <a>C. Bormann</a>, "<a href="https://tools.ietf.org/html/rfc8610">Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures</a>", RFC 8610, DOI 10.17487/RFC8610, June 2019.</td>
</tr>
<tr>
<td class="reference"><b id="TIME_T">[TIME_T]</b></td>
<td class="top">
<a>The Open Group Base Specifications</a>, "<a href="http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap04.html#tag_04_15">Vol. 1: Base Definitions, Issue 7</a>", Section 4.15 'Seconds Since the Epoch', IEEE Std 1003.1, 2013 Edition, 2013.</td>
</tr>
<tr>
<td class="reference"><b id="WGS84">[WGS84]</b></td>
<td class="top">
<a>National Imagery and Mapping Agency</a>, "<a href="http://earth-info.nga.mil/GandG/publications/tr8350.2/wgs84fin.pdf">National Imagery and Mapping Agency Technical Report 8350.2, Third Edition</a>", 2000.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">8.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="ASN.1">[ASN.1]</b></td>
<td class="top">
<a>International Telecommunication Union</a>, "<a>Information Technology -- ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)</a>", ITU-T Recommendation X.690, 1994.</td>
</tr>
<tr>
<td class="reference"><b id="ECMAScript">[ECMAScript]</b></td>
<td class="top">"<a href="http://www.ecma-international.org/ecma-262/5.1/ECMA-262.pdf">Ecma International, "ECMAScript Language Specification, 5.1 Edition", ECMA Standard 262</a>", June 2011.</td>
</tr>
<tr>
<td class="reference"><b id="IDevID">[IDevID]</b></td>
<td class="top">"<a href="http://standards.ieee.org/findstds/standard/802.1AR-2009.html">IEEE Standard, "IEEE 802.1AR Secure Device Identifier"</a>", December 2009.</td>
</tr>
<tr>
<td class="reference"><b id="IEEE.802-2001">[IEEE.802-2001]</b></td>
<td class="top">"<a href="https://webstore.ansi.org/standards/ieee/ieee8022001r2007">IEEE Standard For Local And Metropolitan Area Networks Overview And Architecture</a>", n.d..</td>
</tr>
<tr>
<td class="reference"><b id="IEEE.RA">[IEEE.RA]</b></td>
<td class="top">"<a href="https://standards.ieee.org/products-services/regauth/index.html">IEEE Registration Authority</a>", n.d..</td>
</tr>
<tr>
<td class="reference"><b id="OUI.Guide">[OUI.Guide]</b></td>
<td class="top">"<a href="https://standards.ieee.org/content/dam/ieee-standards/standards/web/documents/tutorials/eui.pdf">Guidelines for Use of Extended Unique Identifier (EUI), Organizationally Unique Identifier (OUI), and Company ID (CID)</a>", August 2017.</td>
</tr>
<tr>
<td class="reference"><b id="OUI.Lookup">[OUI.Lookup]</b></td>
<td class="top">"<a href="https://regauth.standards.ieee.org/standards-ra-web/pub/view.html#registries">IEEE Registration Authority Assignments</a>", n.d..</td>
</tr>
<tr>
<td class="reference"><b id="Webauthn">[Webauthn]</b></td>
<td class="top">
<a>Worldwide Web Consortium</a>, "<a>Web Authentication: A Web API for accessing scoped credentials</a>", 2016.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.A">
<a href="#rfc.appendix.A">Appendix A.</a> <a href="#examples" id="examples">Examples</a>
</h1>
<h1 id="rfc.appendix.A.1">
<a href="#rfc.appendix.A.1">A.1.</a> <a href="#very-simple-eat" id="very-simple-eat">Very Simple EAT</a>
</h1>
<p id="rfc.section.A.1.p.1">This is shown in CBOR diagnostic form. Only the payload signed by COSE is shown.</p>
<pre>
{
   / nonce (cti) /            7:h'948f8860d13a463e8e', 
   / UEID /                   8:h'0198f50a4ff6c05861c8860d13a638ea4fe2f',
   / boot_state /            12:{true, true, true, true, false}
   / time stamp (iat) /       6:1526542894,
}
</pre>
<h1 id="rfc.appendix.A.2">
<a href="#rfc.appendix.A.2">A.2.</a> <a href="#example-with-submodules-nesting-and-security-levels" id="example-with-submodules-nesting-and-security-levels">Example with Submodules, Nesting and Security Levels</a>
</h1>
<pre>
{
   / nonce /                  7:h'948f8860d13a463e8e', 
   / UEID /                   8:h'0198f50a4ff6c05861c8860d13a638ea4fe2f',
   / boot_state /            12:{true, true, true, true, false}
   / time stamp (iat) /       6:1526542894,
   / seclevel /              11:3, / secure restricted OS / 
   
   / submods / 17: 
      [
         / 1st submod, an Android Application / {
           / submod_name /   18:'Android App "Foo"',
           / seclevel /      11:1, / unrestricted / 
           / app data /  -70000:'text string'
         },
         / 2nd submod, A nested EAT from a secure element / {
           / submod_name / 18:'Secure Element EAT',
           / eat /         16:61( 18(
              / an embedded EAT / [ /...COSE_Sign1 bytes with payload.../ ]
                           ))
         }
         / 3rd submod, information about Linux Android / {
            / submod_name/ 18:'Linux Android',
            / seclevel /   11:1, / unrestricted /
            / custom - release / -80000:'8.0.0',
            / custom - version / -80001:'4.9.51+'
         }
      ]
}
</pre>
<h1 id="rfc.appendix.B">
<a href="#rfc.appendix.B">Appendix B.</a> <a href="#changes-from-previous-drafts" id="changes-from-previous-drafts">Changes from Previous Drafts</a>
</h1>
<p id="rfc.section.B.p.1">The following is a list of known changes from the previous drafts.  This list is non-authoritative.  It is meant to help reviewers see the significant differences.</p>
<h1 id="rfc.appendix.B.1">
<a href="#rfc.appendix.B.1">B.1.</a> <a href="#from-draft-mandyam-rats-eat-00" id="from-draft-mandyam-rats-eat-00">From draft-mandyam-rats-eat-00</a>
</h1>
<p id="rfc.section.B.1.p.1">This is a fairly large change in the orientation of the document, but not new claims have been added.</p>
<p></p>

<ul>
<li>Separate information and data model using CDDL.</li>
<li>Say an EAT is a CWT or JWT</li>
<li>Use a map to structure the boot_state and location claims</li>
</ul>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Giridhar Mandyam</span> 
	  <span class="n hidden">
		<span class="family-name">Mandyam</span>
	  </span>
	</span>
	<span class="org vcardline">Qualcomm Technologies Inc.</span>
	<span class="adr">
	  <span class="vcardline">5775 Morehouse Drive</span>

	  <span class="vcardline">
		<span class="locality">San Diego</span>,  
		<span class="region">California</span> 
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">Phone: +1 858 651 7200</span>

<span class="vcardline">EMail: <a href="mailto:mandyam@qti.qualcomm.com">mandyam@qti.qualcomm.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Laurence Lundblade</span> 
	  <span class="n hidden">
		<span class="family-name">Lundblade</span>
	  </span>
	</span>
	<span class="org vcardline">Security Theory LLC</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:lgl@island-resort.com">lgl@island-resort.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Miguel Ballesteros</span> 
	  <span class="n hidden">
		<span class="family-name">Ballesteros</span>
	  </span>
	</span>
	<span class="org vcardline">Qualcomm Technologies Inc.</span>
	<span class="adr">
	  <span class="vcardline">5775 Morehouse Drive</span>

	  <span class="vcardline">
		<span class="locality">San Diego</span>,  
		<span class="region">California</span> 
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">Phone: +1 858 651 4299</span>

<span class="vcardline">EMail: <a href="mailto:mballest@qti.qualcomm.com">mballest@qti.qualcomm.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Jeremy O'Donoghue</span> 
	  <span class="n hidden">
		<span class="family-name">O'Donoghue</span>
	  </span>
	</span>
	<span class="org vcardline">Qualcomm Technologies Inc.</span>
	<span class="adr">
	  <span class="vcardline">279 Farnborough Road</span>

	  <span class="vcardline">
		<span class="locality">Farnborough</span>,  
		<span class="region"></span>
		<span class="code">GU14 7LS</span>
	  </span>
	  <span class="country-name vcardline">United Kingdom</span>
	</span>
	<span class="vcardline">Phone: +44 1252 363189</span>

<span class="vcardline">EMail: <a href="mailto:jodonogh@qti.qualcomm.com">jodonogh@qti.qualcomm.com</a></span>

  </address>
</div>

</body>
</html>

